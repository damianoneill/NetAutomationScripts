{% set node = nodes[inventory_hostname] %}

{#
**************************************************
###         Interfaces configuration        ######
**************************************************
    #}
interfaces {
{% for intf,intf_attr in node.links.items() %}
    {{ intf.split('.')[0] }} {
        description "{{intf_attr.remote}}"
{%      if intf_attr.vlan  is defined %}
        unit {{intf_attr.vlan}} {
            vlan-id {{intf_attr.vlan}};
            family inet {
                address {{intf_attr.ip}}/{{intf_attr.mask|default('30')}}
            }
        }
{%      endif %}
    }   
{% endfor %}
}
protocols {
{#
**************************************************
###         BGP  Variables                  ######
**************************************************
#}
    bgp {
{%      for peer, peer_attr in node.bgp.ebgp.peers.items() %}
        group {{peer}} {
            type external;
            local-address {{ node.rid}};
            family inet {               
                unicast;
            }
            neighbor {{ peer_attr.ip }};
            peer-as {{peer_attr.as}}
{%      endfor %}
        }
    }